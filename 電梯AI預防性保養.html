<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»æ¢¯AIé é˜²ä¿é¤Šç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #1e3c72;
            --secondary-color: #2a5298;
            --accent-color: #667eea;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --bg-light: #f9fafb;
            --border-color: #e5e7eb;
        }
        
        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        /* é ‚éƒ¨å°èˆª */
        .top-nav {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            font-size: 42px;
            animation: rotate 3s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logo-text h1 {
            font-size: 26px;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .logo-text p {
            font-size: 13px;
            color: var(--text-light);
        }
        
        .nav-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-color) 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #d1fae5;
            color: #065f46;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* æ¨™ç±¤é  */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            color: var(--text-dark);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--accent-color) 0%, #764ba2 100%);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* çµ±è¨ˆå¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color) 0%, #764ba2 100%);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }
        
        .stat-icon {
            font-size: 48px;
            opacity: 0.9;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 10px;
        }
        
        .stat-trend {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: 500;
        }
        
        .trend-up {
            background: #d1fae5;
            color: #065f46;
        }
        
        .trend-down {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* ä¸»è¦å…§å®¹å€ */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .card-title {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* é›»æ¢¯å¡ç‰‡ */
        .elevator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .elevator-card {
            background: var(--bg-light);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .elevator-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .elevator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .elevator-id {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .health-badge {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: bold;
        }
        
        .health-excellent { background: #d1fae5; color: #065f46; }
        .health-good { background: #dbeafe; color: #1e40af; }
        .health-warning { background: #fef3c7; color: #92400e; }
        .health-danger { background: #fee2e2; color: #991b1b; }
        
        .subsystem-scores {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }
        
        .subsystem-item {
            background: white;
            padding: 12px;
            border-radius: 10px;
            border-left: 3px solid var(--accent-color);
        }
        
        .subsystem-name {
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 5px;
        }
        
        .subsystem-score {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .progress-excellent { background: var(--success-color); }
        .progress-good { background: #3b82f6; }
        .progress-warning { background: var(--warning-color); }
        .progress-danger { background: var(--danger-color); }
        
        /* é è­¦åˆ—è¡¨ */
        .alert-list {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .alert-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .alert-list::-webkit-scrollbar-track {
            background: var(--bg-light);
            border-radius: 10px;
        }
        
        .alert-list::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 10px;
        }
        
        .alert-item {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 12px;
            border-left: 4px solid;
            transition: all 0.3s;
        }
        
        .alert-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .alert-critical { border-color: var(--danger-color); background: linear-gradient(90deg, #fef2f2 0%, var(--bg-light) 100%); }
        .alert-high { border-color: var(--warning-color); background: linear-gradient(90deg, #fffbeb 0%, var(--bg-light) 100%); }
        .alert-medium { border-color: #3b82f6; background: linear-gradient(90deg, #eff6ff 0%, var(--bg-light) 100%); }
        .alert-low { border-color: var(--success-color); background: linear-gradient(90deg, #f0fdf4 0%, var(--bg-light) 100%); }
        
        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }
        
        .alert-title {
            font-weight: bold;
            color: var(--text-dark);
            font-size: 15px;
        }
        
        .alert-time {
            font-size: 12px;
            color: var(--text-light);
        }
        
        .alert-description {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .alert-action {
            font-size: 13px;
            color: var(--accent-color);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* è©³ç´°è³‡è¨Šæ¨¡æ…‹æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
            animation: fadeIn 0.3s;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 32px;
            cursor: pointer;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            color: var(--danger-color);
            transform: rotate(90deg);
        }
        
        .detail-section {
            margin-bottom: 30px;
        }
        
        .detail-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 20px;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .metric-item {
            background: var(--bg-light);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .metric-label {
            font-size: 13px;
            color: var(--text-light);
            margin-bottom: 8px;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .metric-unit {
            font-size: 14px;
            color: var(--text-light);
            margin-left: 3px;
        }
        
        /* åœ–è¡¨å®¹å™¨ */
        .chart-container {
            background: var(--bg-light);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
        }
        
        /* è¼‰å…¥å‹•ç•« */
        .loading {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid var(--border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 1400px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .top-nav {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .nav-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .elevator-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
        
        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* ç©ºç‹€æ…‹ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }
        
        .empty-state-icon {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-state-text {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .empty-state-subtext {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é ‚éƒ¨å°èˆª -->
        <div class="top-nav">
            <div class="logo">
                <div class="logo-icon">ğŸ¤–</div>
                <div class="logo-text">
                    <h1>é›»æ¢¯AIé é˜²ä¿é¤Šç³»çµ±</h1>
                    <p>Elevator AI Predictive Maintenance System v1.0</p>
                </div>
            </div>
            <div class="nav-controls">
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    ç³»çµ±é‹è¡Œä¸­
                </div>
                <button class="btn btn-secondary" onclick="refreshData()">
                    <span>ğŸ”„</span> é‡æ–°æ•´ç†
                </button>
                <button class="btn btn-primary" onclick="exportReport()">
                    <span>ğŸ“Š</span> åŒ¯å‡ºå ±è¡¨
                </button>
            </div>
        </div>
        
        <!-- æ¨™ç±¤é  -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('overview')">ğŸ“Š ç¸½è¦½</div>
            <div class="tab" onclick="switchTab('elevators')">ğŸ¢ é›»æ¢¯ç›£æ§</div>
            <div class="tab" onclick="switchTab('alerts')">ğŸš¨ é è­¦ç®¡ç†</div>
            <div class="tab" onclick="switchTab('analysis')">ğŸ“ˆ æ•¸æ“šåˆ†æ</div>
            <div class="tab" onclick="switchTab('settings')">âš™ï¸ ç³»çµ±è¨­å®š</div>
        </div>
        
        <!-- ç¸½è¦½æ¨™ç±¤ -->
        <div id="overview" class="tab-content active">
            <!-- çµ±è¨ˆå¡ç‰‡ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">ğŸ¢</div>
                    </div>
                    <div class="stat-value" id="totalElevators">5</div>
                    <div class="stat-label">ç›£æ§é›»æ¢¯ç¸½æ•¸</div>
                    <span class="stat-trend trend-up">â†‘ æ­£å¸¸é‹è¡Œ</span>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">ğŸ’š</div>
                    </div>
                    <div class="stat-value" id="avgHealth">86.4</div>
                    <div class="stat-label">å¹³å‡å¥åº·åº¦</div>
                    <span class="stat-trend trend-up">â†‘ 2.3%</span>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">âš ï¸</div>
                    </div>
                    <div class="stat-value" id="totalAlerts">8</div>
                    <div class="stat-label">å¾…è™•ç†é è­¦</div>
                    <span class="stat-trend trend-down">â†“ 3å€‹</span>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">ğŸ’°</div>
                    </div>
                    <div class="stat-value">4.5M</div>
                    <div class="stat-label">å¹´åº¦ç¯€çœæˆæœ¬ (NT$)</div>
                    <span class="stat-trend trend-up">â†‘ 15%</span>
                </div>
            </div>
            
            <!-- ä¸»è¦å…§å®¹ -->
            <div class="main-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>ğŸ—ï¸</span> é›»æ¢¯å¥åº·ç‹€æ…‹
                        </div>
                    </div>
                    <div id="elevatorOverview" class="elevator-grid"></div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>ğŸš¨</span> æœ€æ–°é è­¦
                        </div>
                    </div>
                    <div id="recentAlerts" class="alert-list"></div>
                </div>
            </div>
        </div>
        
        <!-- é›»æ¢¯ç›£æ§æ¨™ç±¤ -->
        <div id="elevators" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>ğŸ¢</span> æ‰€æœ‰é›»æ¢¯è©³ç´°ç›£æ§
                    </div>
                    <button class="btn btn-primary" onclick="addElevator()">
                        <span>â•</span> æ–°å¢é›»æ¢¯
                    </button>
                </div>
                <div id="allElevators" class="elevator-grid"></div>
            </div>
        </div>
        
        <!-- é è­¦ç®¡ç†æ¨™ç±¤ -->
        <div id="alerts" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>ğŸš¨</span> é è­¦ç®¡ç†ä¸­å¿ƒ
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <select class="btn btn-secondary" id="alertFilter" onchange="filterAlerts()">
                            <option value="all">å…¨éƒ¨é è­¦</option>
                            <option value="critical">åš´é‡</option>
                            <option value="high">é«˜</option>
                            <option value="medium">ä¸­</option>
                            <option value="low">ä½</option>
                        </select>
                    </div>
                </div>
                <div id="allAlerts" class="alert-list"></div>
            </div>
        </div>
        
        <!-- æ•¸æ“šåˆ†ææ¨™ç±¤ -->
        <div id="analysis" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>ğŸ“ˆ</span> AIæ•¸æ“šåˆ†æ
                    </div>
                </div>
                <div class="chart-container">
                    <div style="text-align: center;">
                        <div class="loading"></div>
                        <p style="margin-top: 20px;">åœ–è¡¨è¼‰å…¥ä¸­...</p>
                        <p style="font-size: 12px; margin-top: 10px;">æ•´åˆ Chart.js æˆ– Google Charts ä¾†é¡¯ç¤ºè¶¨å‹¢åœ–è¡¨</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç³»çµ±è¨­å®šæ¨™ç±¤ -->
        <div id="settings" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>âš™ï¸</span> ç³»çµ±è¨­å®š
                    </div>
                </div>
                <div class="detail-section">
                    <h3>Google Apps Script è¨­å®š</h3>
                    <div style="background: var(--bg-light); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: bold;">Apps Script Web App URL:</label>
                        <input type="text" id="gasUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec" 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 14px;">
                        <button class="btn btn-primary" style="margin-top: 15px;" onclick="saveGasUrl()">
                            <span>ğŸ’¾</span> å„²å­˜è¨­å®š
                        </button>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>é–¾å€¼è¨­å®š</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">é¦¬é”æº«åº¦ä¸Šé™</div>
                            <input type="number" value="80" style="width: 80px; padding: 8px; text-align: center; border: 2px solid var(--border-color); border-radius: 8px; font-size: 18px; font-weight: bold;">
                            <span class="metric-unit">Â°C</span>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æŒ¯å‹•ä¸Šé™</div>
                            <input type="number" value="0.15" step="0.01" style="width: 80px; padding: 8px; text-align: center; border: 2px solid var(--border-color); border-radius: 8px; font-size: 18px; font-weight: bold;">
                            <span class="metric-unit">g</span>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">é–€åŠ›ä¸Šé™</div>
                            <input type="number" value="150" style="width: 80px; padding: 8px; text-align: center; border: 2px solid var(--border-color); border-radius: 8px; font-size: 18px; font-weight: bold;">
                            <span class="metric-unit">N</span>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">é‹¼ç´¢å¼µåŠ›å·®ä¸Šé™</div>
                            <input type="number" value="10" style="width: 80px; padding: 8px; text-align: center; border: 2px solid var(--border-color); border-radius: 8px; font-size: 18px; font-weight: bold;">
                            <span class="metric-unit">%</span>
                        </div>
                    </div>
                    <button class="btn btn-primary" style="margin-top: 20px;" onclick="saveThresholds()">
                        <span>ğŸ’¾</span> å„²å­˜é–¾å€¼è¨­å®š
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- è©³ç´°è³‡è¨Šæ¨¡æ…‹æ¡† -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>
    
    <script>
        // å…¨åŸŸè®Šæ•¸
        let gasUrl = localStorage.getItem('gasUrl') || '';
        let elevatorData = [];
        let alertsData = [];
        
        // æ¨¡æ“¬æ•¸æ“šï¼ˆå¯¦éš›æ‡‰ç”¨ä¸­å¾GAS APIç²å–ï¼‰
        const mockElevatorData = [
            {
                id: 'ELV-001',
                name: 'Aæ£Ÿ1è™Ÿæ¢¯',
                location: 'Aæ£Ÿ',
                overallScore: 95,
                grade: 'A',
                minRUL: 180,
                status: 'excellent',
                subsystemScores: {
                    mainMachine: 93,
                    comfort: 96,
                    door: 94,
                    rope: 97
                },
                metrics: {
                    motorTemp: 65,
                    bearingTemp: 62,
                    vibration: 0.08,
                    doorForce: 120,
                    ropeTension: 5
                }
            },
            {
                id: 'ELV-002',
                name: 'Aæ£Ÿ2è™Ÿæ¢¯',
                location: 'Aæ£Ÿ',
                overallScore: 88,
                grade: 'B',
                minRUL: 90,
                status: 'good',
                subsystemScores: {
                    mainMachine: 85,
                    comfort: 90,
                    door: 88,
                    rope: 89
                },
                metrics: {
                    motorTemp: 68,
                    bearingTemp: 65,
                    vibration: 0.12,
                    doorForce: 135,
                    ropeTension: 7
                }
            },
            {
                id: 'ELV-003',
                name: 'Bæ£Ÿ1è™Ÿæ¢¯',
                location: 'Bæ£Ÿ',
                overallScore: 72,
                grade: 'C',
                minRUL: 14,
                status: 'warning',
                subsystemScores: {
                    mainMachine: 78,
                    comfort: 75,
                    door: 65,
                    rope: 70
                },
                metrics: {
                    motorTemp: 75,
                    bearingTemp: 72,
                    vibration: 0.18,
                    doorForce: 155,
                    ropeTension: 11
                }
            },
            {
                id: 'ELV-004',
                name: 'Bæ£Ÿ2è™Ÿæ¢¯',
                location: 'Bæ£Ÿ',
                overallScore: 92,
                grade: 'A',
                minRUL: 150,
                status: 'excellent',
                subsystemScores: {
                    mainMachine: 90,
                    comfort: 93,
                    door: 92,
                    rope: 93
                },
                metrics: {
                    motorTemp: 63,
                    bearingTemp: 60,
                    vibration: 0.09,
                    doorForce: 115,
                    ropeTension: 4
                }
            },
            {
                id: 'ELV-005',
                name: 'Cæ£Ÿ1è™Ÿæ¢¯',
                location: 'Cæ£Ÿ',
                overallScore: 85,
                grade: 'B',
                minRUL: 60,
                status: 'good',
                subsystemScores: {
                    mainMachine: 82,
                    comfort: 88,
                    door: 84,
                    rope: 86
                },
                metrics: {
                    motorTemp: 67,
                    bearingTemp: 64,
                    vibration: 0.11,
                    doorForce: 130,
                    ropeTension: 6
                }
            }
        ];
        
        const mockAlertsData = [
            {
                id: 'ALT-001',
                elevatorId: 'ELV-003',
                elevatorName: 'Bæ£Ÿ1è™Ÿæ¢¯',
                type: 'bearing_overheat',
                severity: 'high',
                message: 'è»¸æ‰¿æº«åº¦éé«˜: 78Â°C (é–¾å€¼: 75Â°C)',
                recommendation: 'æª¢æŸ¥è»¸æ‰¿æ½¤æ»‘ï¼Œè€ƒæ…®æ›´æ›è»¸æ‰¿',
                timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000),
                status: 'pending'
            },
            {
                id: 'ALT-002',
                elevatorId: 'ELV-003',
                elevatorName: 'Bæ£Ÿ1è™Ÿæ¢¯',
                type: 'excessive_vibration',
                severity: 'medium',
                message: 'æŒ¯å‹•éå¤§: 0.18g (é–¾å€¼: 0.15g)',
                recommendation: 'æª¢æŸ¥è¯è»¸å™¨å°ä¸­ã€è»¸æ‰¿ç‹€æ…‹ã€åŸºç¤èºæ “',
                timestamp: new Date(Date.now() - 3 * 60 * 60 * 1000),
                status: 'pending'
            },
            {
                id: 'ALT-003',
                elevatorId: 'ELV-002',
                elevatorName: 'Aæ£Ÿ2è™Ÿæ¢¯',
                type: 'door_maintenance_due',
                severity: 'low',
                message: 'é–€å¾ªç’°æ¬¡æ•¸æ¥è¿‘ä¿é¤Šé€±æœŸ: 850000æ¬¡',
                recommendation: 'è¨ˆåŠƒæ›´æ›é–€æ©Ÿçš®å¸¶ã€é–€åŠè¼ªç­‰æ˜“æä»¶',
                timestamp: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                status: 'pending'
            },
            {
                id: 'ALT-004',
                elevatorId: 'ELV-005',
                elevatorName: 'Cæ£Ÿ1è™Ÿæ¢¯',
                type: 'rope_tension_unbalance',
                severity: 'medium',
                message: 'é‹¼ç´¢å¼µåŠ›ä¸å‡: 8.5% (é–¾å€¼: 10%)',
                recommendation: 'å»ºè­°èª¿æ•´é‹¼ç´¢å¼µåŠ›ï¼Œç¢ºä¿å¹³è¡¡',
                timestamp: new Date(Date.now() - 5 * 60 * 60 * 1000),
                status: 'pending'
            },
            {
                id: 'ALT-005',
                elevatorId: 'ELV-001',
                elevatorName: 'Aæ£Ÿ1è™Ÿæ¢¯',
                type: 'scheduled_maintenance',
                severity: 'low',
                message: 'æ¥è¿‘å®šæœŸä¿é¤Šæ™‚æ•¸: 9500å°æ™‚',
                recommendation: 'è¨ˆåŠƒé€²è¡Œå…¨é¢ä¿é¤Šï¼Œæ›´æ›æ˜“æä»¶',
                timestamp: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                status: 'pending'
            }
        ];
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderOverview();
            renderAllElevators();
            renderAllAlerts();
            
            // è¼‰å…¥å„²å­˜çš„GAS URL
            if (gasUrl) {
                document.getElementById('gasUrl').value = gasUrl;
            }
        });
        
        // è¼‰å…¥æ•¸æ“š
        function loadData() {
            // å¯¦éš›æ‡‰ç”¨ä¸­æ‡‰è©²å¾GAS APIç²å–æ•¸æ“š
            elevatorData = mockElevatorData;
            alertsData = mockAlertsData;
            
            // æ›´æ–°çµ±è¨ˆæ•¸æ“š
            updateStats();
        }
        
        // æ›´æ–°çµ±è¨ˆæ•¸æ“š
        function updateStats() {
            const avgHealth = elevatorData.reduce((sum, e) => sum + e.overallScore, 0) / elevatorData.length;
            document.getElementById('avgHealth').textContent = avgHealth.toFixed(1);
            document.getElementById('totalElevators').textContent = elevatorData.length;
            document.getElementById('totalAlerts').textContent = alertsData.filter(a => a.status === 'pending').length;
        }
        
        // æ¸²æŸ“ç¸½è¦½
        function renderOverview() {
            const container = document.getElementById('elevatorOverview');
            container.innerHTML = '';
            
            elevatorData.slice(0, 4).forEach(elevator => {
                container.innerHTML += createElevatorCard(elevator);
            });
            
            renderRecentAlerts();
        }
        
        // æ¸²æŸ“æ‰€æœ‰é›»æ¢¯
        function renderAllElevators() {
            const container = document.getElementById('allElevators');
            container.innerHTML = '';
            
            elevatorData.forEach(elevator => {
                container.innerHTML += createElevatorCard(elevator);
            });
        }
        
        // å‰µå»ºé›»æ¢¯å¡ç‰‡
        function createElevatorCard(elevator) {
            const healthClass = elevator.overallScore >= 90 ? 'excellent' : 
                                elevator.overallScore >= 80 ? 'good' : 
                                elevator.overallScore >= 60 ? 'warning' : 'danger';
            
            return `
                <div class="elevator-card" onclick="showElevatorDetail('${elevator.id}')">
                    <div class="elevator-header">
                        <div class="elevator-id">ğŸ”· ${elevator.id} | ${elevator.name}</div>
                        <span class="health-badge health-${healthClass}">${elevator.grade}ç´š ${elevator.overallScore}åˆ†</span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: white; border-radius: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span style="color: var(--text-light); font-size: 14px;">æ•´é«”å¥åº·åº¦</span>
                            <span style="font-weight: bold; color: var(--primary-color);">${elevator.overallScore}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill progress-${healthClass}" style="width: ${elevator.overallScore}%"></div>
                        </div>
                        <div style="margin-top: 10px; font-size: 13px; color: var(--text-light);">
                            â±ï¸ é æ¸¬RUL: ${elevator.minRUL}å¤©
                        </div>
                    </div>
                    <div class="subsystem-scores">
                        <div class="subsystem-item">
                            <div class="subsystem-name">ğŸ”§ ä¸»æ©Ÿç³»çµ±</div>
                            <div class="subsystem-score">${elevator.subsystemScores.mainMachine}</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-${getScoreClass(elevator.subsystemScores.mainMachine)}" 
                                     style="width: ${elevator.subsystemScores.mainMachine}%"></div>
                            </div>
                        </div>
                        <div class="subsystem-item">
                            <div class="subsystem-name">ğŸ˜Š ä¹˜åèˆ’é©</div>
                            <div class="subsystem-score">${elevator.subsystemScores.comfort}</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-${getScoreClass(elevator.subsystemScores.comfort)}" 
                                     style="width: ${elevator.subsystemScores.comfort}%"></div>
                            </div>
                        </div>
                        <div class="subsystem-item">
                            <div class="subsystem-name">ğŸšª é–€ç³»çµ±</div>
                            <div class="subsystem-score">${elevator.subsystemScores.door}</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-${getScoreClass(elevator.subsystemScores.door)}" 
                                     style="width: ${elevator.subsystemScores.door}%"></div>
                            </div>
                        </div>
                        <div class="subsystem-item">
                            <div class="subsystem-name">ğŸ”— é‹¼ç´¢ç³»çµ±</div>
                            <div class="subsystem-score">${elevator.subsystemScores.rope}</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-${getScoreClass(elevator.subsystemScores.rope)}" 
                                     style="width: ${elevator.subsystemScores.rope}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // æ¸²æŸ“æœ€æ–°é è­¦
        function renderRecentAlerts() {
            const container = document.getElementById('recentAlerts');
            container.innerHTML = '';
            
            const recentAlerts = alertsData.slice(0, 5);
            
            if (recentAlerts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">âœ…</div>
                        <div class="empty-state-text">ç›®å‰æ²’æœ‰é è­¦</div>
                        <div class="empty-state-subtext">æ‰€æœ‰é›»æ¢¯é‹è¡Œæ­£å¸¸</div>
                    </div>
                `;
                return;
            }
            
            recentAlerts.forEach(alert => {
                container.innerHTML += createAlertItem(alert);
            });
        }
        
        // æ¸²æŸ“æ‰€æœ‰é è­¦
        function renderAllAlerts() {
            const container = document.getElementById('allAlerts');
            container.innerHTML = '';
            
            if (alertsData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">âœ…</div>
                        <div class="empty-state-text">ç›®å‰æ²’æœ‰é è­¦</div>
                        <div class="empty-state-subtext">æ‰€æœ‰é›»æ¢¯é‹è¡Œæ­£å¸¸</div>
                    </div>
                `;
                return;
            }
            
            alertsData.forEach(alert => {
                container.innerHTML += createAlertItem(alert);
            });
        }
        
        // å‰µå»ºé è­¦é …ç›®
        function createAlertItem(alert) {
            const icon = alert.severity === 'critical' ? 'ğŸ”´' : 
                        alert.severity === 'high' ? 'ğŸŸ ' : 
                        alert.severity === 'medium' ? 'ğŸ”µ' : 'ğŸŸ¢';
            
            const timeAgo = getTimeAgo(alert.timestamp);
            
            return `
                <div class="alert-item alert-${alert.severity}">
                    <div class="alert-header">
                        <div class="alert-title">${icon} ${alert.elevatorName} - ${alert.type}</div>
                        <div class="alert-time">${timeAgo}</div>
                    </div>
                    <div class="alert-description">${alert.message}</div>
                    <div class="alert-action">ğŸ‘‰ ${alert.recommendation}</div>
                </div>
            `;
        }
        
        // é¡¯ç¤ºé›»æ¢¯è©³ç´°è³‡è¨Š
        function showElevatorDetail(elevatorId) {
            const elevator = elevatorData.find(e => e.id === elevatorId);
            if (!elevator) return;
            
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <h2 style="color: var(--primary-color); margin-bottom: 20px;">
                    ${elevator.id} - ${elevator.name} è©³ç´°è³‡è¨Š
                </h2>
                
                <div class="detail-section">
                    <h3>æ•´é«”è©•ä¼°</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">å¥åº·è©•åˆ†</div>
                            <div class="metric-value">${elevator.overallScore}<span class="metric-unit">åˆ†</span></div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">è©•ç´š</div>
                            <div class="metric-value">${elevator.grade}<span class="metric-unit">ç´š</span></div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">é æ¸¬RUL</div>
                            <div class="metric-value">${elevator.minRUL}<span class="metric-unit">å¤©</span></div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">ç‹€æ…‹</div>
                            <div class="metric-value" style="font-size: 18px;">${getStatusText(elevator.status)}</div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>ğŸ”§ ä¸»æ©Ÿç³»çµ± (${elevator.subsystemScores.mainMachine}åˆ†)</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">é¦¬é”æº«åº¦</div>
                            <div class="metric-value">${elevator.metrics.motorTemp}<span class="metric-unit">Â°C</span></div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">è»¸æ‰¿æº«åº¦</div>
                            <div class="metric-value">${elevator.metrics.bearingTemp}<span class="metric-unit">Â°C</span></div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æŒ¯å‹•å€¼</div>
                            <div class="metric-value">${elevator.metrics.vibration}<span class="metric-unit">g</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>ğŸšª é–€ç³»çµ± (${elevator.subsystemScores.door}åˆ†)</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">é–‹é—œé–€åŠ›</div>
                            <div class="metric-value">${elevator.metrics.doorForce}<span class="metric-unit">N</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>ğŸ”— é‹¼ç´¢ç³»çµ± (${elevator.subsystemScores.rope}åˆ†)</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">å¼µåŠ›å·®</div>
                            <div class="metric-value">${elevator.metrics.ropeTension}<span class="metric-unit">%</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <p>æ­·å²è¶¨å‹¢åœ–è¡¨ï¼ˆå¯æ•´åˆChart.jsé¡¯ç¤ºï¼‰</p>
                </div>
            `;
            
            modal.classList.add('active');
        }
        
        // é—œé–‰æ¨¡æ…‹æ¡†
        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }
        
        // åˆ‡æ›æ¨™ç±¤
        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰activeé¡
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // æ·»åŠ activeé¡åˆ°é¸ä¸­çš„æ¨™ç±¤
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        // é‡æ–°æ•´ç†æ•¸æ“š
        function refreshData() {
            const btn = event.target.closest('.btn');
            btn.disabled = true;
            btn.innerHTML = '<span>ğŸ”„</span> è¼‰å…¥ä¸­...';
            
            // æ¨¡æ“¬APIè«‹æ±‚
            setTimeout(() => {
                loadData();
                renderOverview();
                renderAllElevators();
                renderAllAlerts();
                
                btn.disabled = false;
                btn.innerHTML = '<span>ğŸ”„</span> é‡æ–°æ•´ç†';
                
                alert('âœ… æ•¸æ“šå·²æ›´æ–°ï¼');
            }, 1000);
        }
        
        // åŒ¯å‡ºå ±è¡¨
        function exportReport() {
            alert('ğŸ“Š å ±è¡¨åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­...\n\nå°‡æ”¯æ´åŒ¯å‡ºç‚º PDF æˆ– Excel æ ¼å¼');
        }
        
        // æ–°å¢é›»æ¢¯
        function addElevator() {
            alert('â• æ–°å¢é›»æ¢¯åŠŸèƒ½é–‹ç™¼ä¸­...\n\nè«‹åœ¨Google Sheetsä¸­æ·»åŠ é›»æ¢¯è³‡æ–™');
        }
        
        // ç¯©é¸é è­¦
        function filterAlerts() {
            const filter = document.getElementById('alertFilter').value;
            const container = document.getElementById('allAlerts');
            
            let filteredAlerts = alertsData;
            if (filter !== 'all') {
                filteredAlerts = alertsData.filter(a => a.severity === filter);
            }
            
            container.innerHTML = '';
            filteredAlerts.forEach(alert => {
                container.innerHTML += createAlertItem(alert);
            });
        }
        
        // å„²å­˜GAS URL
        function saveGasUrl() {
            const url = document.getElementById('gasUrl').value;
            if (url) {
                localStorage.setItem('gasUrl', url);
                gasUrl = url;
                alert('âœ… Google Apps Script URL å·²å„²å­˜ï¼');
            } else {
                alert('âš ï¸ è«‹è¼¸å…¥æœ‰æ•ˆçš„URL');
            }
        }
        
        // å„²å­˜é–¾å€¼è¨­å®š
        function saveThresholds() {
            alert('âœ… é–¾å€¼è¨­å®šå·²å„²å­˜ï¼\n\nå¯¦éš›æ‡‰ç”¨ä¸­æœƒåŒæ­¥åˆ°Google Sheets');
        }
        
        // è¼”åŠ©å‡½æ•¸
        function getScoreClass(score) {
            if (score >= 90) return 'excellent';
            if (score >= 80) return 'good';
            if (score >= 60) return 'warning';
            return 'danger';
        }
        
        function getStatusText(status) {
            const statusMap = {
                'excellent': 'å„ªç§€',
                'good': 'è‰¯å¥½',
                'warning': 'æ³¨æ„',
                'critical': 'åš´é‡'
            };
            return statusMap[status] || status;
        }
        
        function getTimeAgo(timestamp) {
            const now = new Date();
            const diff = now - timestamp;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const days = Math.floor(hours / 24);
            
            if (days > 0) return `${days}å¤©å‰`;
            if (hours > 0) return `${hours}å°æ™‚å‰`;
            return 'å‰›å‰›';
        }
        
        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰
        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
